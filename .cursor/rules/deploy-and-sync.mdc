---
description: How to push to GitHub and sync frontend to the live app from Cursor
globs: 
alwaysApply: false
---

# Deploy and sync from Cursor

## Pushing to GitHub — always use the token from Cursor

**Do not run plain `git push origin main`** from Cursor. It fails with: `fatal: could not read Username for 'https://github.com': Device not configured` (no interactive auth). Use **GITHUB_TOKEN** via **scripts/git-push-with-token.sh** so push goes straight to GitHub.

**Always use the GitHub token:**

1. **GITHUB_TOKEN** must be set (e.g. in this repo's **.env** or **env** file, or in Cursor env). See **docs/GITHUB-PUSH-AND-SYNC-SETUP.md**.
2. **When pushing this repo (Music Bingo Backend):**  
   Source the env, then run the token script:
   ```bash
   cd "/path/to/Music Bingo Backend"
   [ -f .env ] && set -a && source .env && set +a
   [ -f env ] && set -a && source env && set +a
   export GITHUB_TOKEN
   ./scripts/git-push-with-token.sh
   ```
   Or run **./scripts/deploy-playroom.sh** (it uses the script and loads .env/env).
3. **When pushing music-bingo-app:**  
   From the app repo, run the **backend's** token script so GITHUB_TOKEN is used:
   ```bash
   cd "/path/to/music-bingo-app"
   [ -f ../Music\ Bingo\ Backend/.env ] && set -a && source ../Music\ Bingo\ Backend/.env && set +a
   export GITHUB_TOKEN
   /path/to/Music\ Bingo\ Backend/scripts/git-push-with-token.sh
   ```
   Or use **sync-and-push-roll-call.sh** from the backend (it pushes the app with the token).

**Rule:** From now on, any push from Cursor must use the token (script or deploy/sync scripts that call it). This keeps pushes smooth and avoids auth errors.

## Live site: one repo (bingo-backend)

- The **Playroom live site** (Netlify) should build from **this repo** (bingo-backend), **frontend/** directory. See **.cursor/rules/deploy-netlify-railway-one-repo.mdc** and **docs/DEPLOY-CONTRACT.md**.
- If the live site shows the wrong or old UI, run **./scripts/ensure-netlify-builds-from-backend.sh** (with NETLIFY_AUTH_TOKEN and NETLIFY_SITE_ID in .env it will set Netlify build settings; otherwise it prints manual steps).
- **Optional:** **sync-and-push-roll-call.sh** and **music-bingo-app** are for syncing only Roll Call–related files to a separate app repo if you still use it; the main Playroom site is built from bingo-backend/frontend.

## When to run what

- **Deploy (push + optional Netlify):** Run `./scripts/deploy-playroom.sh` (uses GITHUB_TOKEN; set DEPLOY_NETLIFY=1 to deploy frontend to Netlify).
- **Netlify showing wrong UI / wrong repo:** Run `./scripts/ensure-netlify-builds-from-backend.sh`, then trigger deploy in Netlify and hard refresh.
- **One-time setup:** See **docs/GITHUB-PUSH-AND-SYNC-SETUP.md** (PAT, GITHUB_TOKEN). For Netlify/Railway: **docs/DEPLOY-CONTRACT.md**.
